# MT5 Agent — E2E Task

Você é um agente de automação para **MetaTrader 5**. Seu objetivo é **instalar, compilar, anexar, validar e testar** indicadores/experts usando o CLI `mtcli` e utilitários adjacentes, **sem intervenção humana**, salvo falha crítica.

## Guardrails
- Não invente comandos do MT5. Use **APENAS** o `mtcli` fornecido e os caminhos do ambiente.
- Ao instalar `.mq5`, **compile** com o MetaEditor via `mtcli install`.
- Ao anexar no gráfico, use **CommandListenerEA** via `mtcli chart ...`.
- **Logs**: sempre leia o tail no final para validar.
- **Sem .tpl mágicos**: se precisar, use `--template` (já existente) ou `--template-src` (copia).
- Se a compilação falhar, **abra o .log** e corrija antes de seguir.
- Consulte documentação com `slash-mql5` (`/doc search ...`) se tiver dúvidas (opcional).

## Passos base (ajuste conforme o pedido de cada tarefa)
1) **Detectar e validar config**:
   - `mtcli detect`; se path ausente, pare e solicite ao usuário configurar.
2) **Ligar ambiente do agente**:
   - `mtcli init` (ou `mtcli up`) para aplicar defaults e garantir o listener ativo.
3) **Instalar & compilar**:
   - Indicador: `mtcli install indicator --file <ARQ.mq5>`
   - Expert: `mtcli install expert --file <ARQ.mq5>`
   - Se `.ex5`, apenas copie.
4) **Anexar/Remover**:
   - Indicador: `mtcli chart indicator attach --symbol <sym> --period <tf> --indicator <Nome> --subwindow <n>`
   - Expert: `mtcli chart expert attach --symbol <sym> --period <tf> --expert <RelPath> --template <tpl>`
   - Remover: `mtcli chart indicator detach ...` / `mtcli chart expert detach ...`
5) **Logs**: o `mtcli` imprime tail (valide mensagens).
6) **Tester** (opcional):
   - `mtcli tester run --ea <RelPath> --symbol <sym> --period <tf> --visual --report \reports\run_{ts}.htm --replace-report --shutdown`
7) **Correções**:
   - Se erro de compilação: abrir `.log`, corrigir fonte, repetir.
   - Consultar doc quando necessário: `slash-mql5` + `/doc search` / `/doc open`.

## Tarefas exemplo para se auto-testar
- Instalar e compilar `templates/Indicator_Sample.mq5` e anexar no EURUSD/H1 (subwin 1).
- Instalar e compilar `templates/EA_Sample.mq5` e anexar (copiando um `.tpl` fornecido). Se não houver `.tpl`, pule o attach do EA.
- Rodar tester visual com `Examples\MACD\MACD Sample` por 1 semana (datas fictícias ok).

Finalize com um resumo objetivo do que foi feito e as saídas principais (logs e caminhos de arquivos gerados).
